<!--
***********************************************************************************************
Microsoft.NET.Sdk.Razor.SourceGenerators.targets

WARNING:  DO NOT MODIFY this file unless you are knowledgeable about MSBuild and have
          created a backup copy.  Incorrect changes to this file will make it
          impossible to load or build your projects from the command-line or the IDE.

Copyright (c) .NET Foundation. All rights reserved.
***********************************************************************************************
-->

<Project ToolsVersion="14.0">

  <Target Name="_PrepareRazorSourceGenerators" BeforeTargets="PrepareForBuild" DependsOnTargets="ResolveRazorGenerateInputs;PrepareForRazorComponentGenerate">
    <PropertyGroup>
      <_RazorSdkSourceGeneratorDirectoryRoot>$(RazorSdkDirectoryRoot)source-generators\</_RazorSdkSourceGeneratorDirectoryRoot>
    </PropertyGroup>
    
    <!-- Configure analyzers -->
    <ItemGroup>
      <Analyzer Include="$(_RazorSdkSourceGeneratorDirectoryRoot)Newtonsoft.Json.dll" />
      <Analyzer Include="$(_RazorSdkSourceGeneratorDirectoryRoot)Microsoft.AspNetCore.Mvc.Razor.Extensions.dll" />
      <Analyzer Include="$(_RazorSdkSourceGeneratorDirectoryRoot)Microsoft.AspNetCore.Razor.Language.dll" />
      <Analyzer Include="$(_RazorSdkSourceGeneratorDirectoryRoot)Microsoft.CodeAnalysis.Razor.dll" />
      <Analyzer Include="$(_RazorSdkSourceGeneratorDirectoryRoot)RazorSourceGenerators.dll" />
    </ItemGroup>

    <PropertyGroup>
      <_IntermediateOutputFullPath>$(MSBuildProjectDirectory)\$(IntermediateOutputPath)</_IntermediateOutputFullPath>
    </PropertyGroup>

    <ItemGroup>
      <!-- Additional metadata and properties that we want the compiler to pass to   the compiler we want to pass additional MSBuild properties \ metadata -->
      <CompilerVisibleItemMetadata Include="AdditionalFiles" MetadataName="TargetPath" />
      <CompilerVisibleItemMetadata Include="AdditionalFiles" MetadataName="CssScope" />
      <CompilerVisibleProperty Include="RazorLangVersion" />
      <CompilerVisibleProperty Include="RootNamespace" />
      <CompilerVisibleProperty Include="_IntermediateOutputFullPath" />

      <!-- Indicate to the analyzer where tag helpers need to be stashed away if view compilation is to follow. -->
      <CompilerVisibleProperty Include="_RazorTagHelperOutputCache" Condition="'@(RazorGenerate->Count())' != '0'" />
    </ItemGroup>

    <ItemGroup>
      <!-- Pass razor files to the compiler. -->
      <AdditionalFiles Include="@(RazorComponentWithTargetPath)" />
    </ItemGroup>
 </Target>

</Project>
